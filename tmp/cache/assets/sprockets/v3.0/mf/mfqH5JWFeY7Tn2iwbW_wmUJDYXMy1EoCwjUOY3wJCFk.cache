I"¯(function() {
  var ready;

  ready = function() {
    var $forbid_access, $force_access;
    $force_access = $('#force_access');
    $forbid_access = $('#forbid_access');
    $('.access-toggler').on('change', function() {
      var checked_access;
      checked_access = $(this).attr('id');
      if (checked_access === 'force_access') {
        if ($force_access.prop('checked') && $forbid_access.prop('checked')) {
          $forbid_access.bootstrapToggle('off');
        }
      } else if (checked_access === 'forbid_access') {
        if ($forbid_access.is(':checked') && $force_access.is(':checked')) {
          $force_access.bootstrapToggle('off');
        }
      }
      return $.ajax({
        type: 'POST',
        url: $(this).data('path'),
        data: {
          state: $(this).prop('checked')
        },
        dataType: 'json',
        success: function(data) {
          var access, has_mandate, has_payments;
          has_mandate = $("#access-mandate").data('state');
          has_payments = $("#access-payments").data('state');
          if (data.force === true) {
            access = true;
          } else if (data.forbid === true) {
            access = false;
          } else if (has_mandate && has_payments) {
            access = true;
          } else {
            access = false;
          }
          return $('#access_planning strong').eq(0).toggleClass('hide', !access).end().eq(1).toggleClass('hide', access);
        }
      });
    });
    return $('#payment_mode').on('change', function() {
      var $this, payment_mode, ref;
      $this = $(this);
      payment_mode = (ref = $this.prop('checked')) != null ? ref : {
        'cb': 'sepa'
      };
      return $.ajax({
        type: 'PATCH',
        url: $this.data('path'),
        dataType: 'json',
        data: {
          payment_mode: payment_mode
        },
        complete: function(data) {
          var answer;
          answer = JSON.parse(data.responseText);
          if (answer['status'] !== 200) {
            return $('#payment_mode').parents('.form-group').append("<p class='text-danger'>" + answer['errors'] + "</p>");
          }
        }
      });
    });
  };

  $(document).ready(ready);

}).call(this);
:ET